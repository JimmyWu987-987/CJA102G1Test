-- 最新消息 --

CREATE TABLE NEWS (
	NEWS_ID int NOT NULL PRIMARY KEY,
	NEWS_TITLE varchar(50) NOT NULL,
	NEWS_CONT varchar(1000) NOT NULL,
	NEWS_AT datetime NOT NULL
);

INSERT INTO NEWS (NEWS_ID, NEWS_TITLE, NEWS_CONT, NEWS_AT, NEWS_CATE_ID) VALUES
(1, '網站更新', '我們的網站已經更新至最新版本，提供更好的使用者體驗。', '2024-05-20 10:30:00'),
(1, '夏季特賣會', '所有商品8折優惠，只到月底！', '2024-06-01 15:00:00');

-- 小農商品 --

CREATE TABLE PRODUCT (
    PRO_ID int NOT NULL PRIMARY KEY AUTO_INCREMENT,
    PRO_NAME VARCHAR(100) NOT NULL,
    PRO_STOCK int NOT NULL,
    PRO_PRICE int NOT NULL,
    PRO_STATUS int NOT NULL DEFAULT 0,
    PRO_SCORE int,
    PRO_CNT int
);

INSERT INTO PRODUCT (PRO_NAME, PRO_STOCK, F_MEM_ID, PRO_PRICE, PRO_STATUS, PRO_CATE_ID, PRO_SCORE, PRO_CNT) VALUES
('有機小白菜', 50, 1, 80, 1, 1, 4.5, 10),
('放山雞', 20, 2, 250, 1, 2, 4.8, 15),
('新鮮雞蛋', 100, 1, 120, 0, 1, 4.0, 5);

-- 小農編號跟類別編號要再對照別的欄位 --

-- 管理員職稱表 --

CREATE TABLE ADMIN_TYPE (
    ADMIN_TYPE_ID INT NOT NULL PRIMARY KEY,
    ADMIN_TYPE_NAME VARCHAR(20) NOT NULL
);

INSERT INTO ADMIN_TYPE (ADMIN_TYPE_ID, ADMIN_TYPE_NAME) VALUES
(1, '超級管理員'),
(2, '中級管理員'),
(3, '低級人員');
    
--  管理員 --

CREATE TABLE ADMINISTRATOR (
    ADMIN_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    ADMIN_ACC VARCHAR(20) NOT NULL,
    ADMIN_PWD VARCHAR(20) NOT NULL,
    ADMIN_STATUS TINYINT NOT NULL DEFAULT 0,
    ADMIN_NAME VARCHAR(20) NOT NULL,
    ADMIN_EMAIL VARCHAR(40) NOT NULL,
    ADMIN_MOBILE VARCHAR(11) NOT NULL,
    ADMIN_PIC LONGBLOB
);
    
INSERT INTO `ADMINISTRATOR` (ADMIN_ID, ADMIN_TYPE_ID, ADMIN_ACC, ADMIN_PWD, ADMIN_STATUS, ADMIN_NAME, ADMIN_EMAIL, ADMIN_MOBILE) VALUES
(1, 'admin1', 'pwd123', 1, '張三', 'admin1@email.com', '0912345678') 
(2, 'admin2', 'pwd456', 1, '李四', 'admin2@email.com', '0912345679')
(3, 'admin3', 'pwd789', 0, '王五', 'admin3@email.com', '0912345680') 
    
-- 功能權限表 --
 
CREATE TABLE ADMIN_FUNCTION (
    ADMIN_FUNC_ID INT NOT NULL PRIMARY KEY,
    ADMIN_FUNC_NAME VARCHAR(20) NOT NULL,
    ADMIN_FUNC_DES VARCHAR(100) NOT NULL
);
    
INSERT INTO ADMIN_FUNCTION (ADMIN_FUNC_ID, ADMIN_FUNC_NAME, ADMIN_FUNC_DES) VALUES
(1, '網站總管理', '商品活動廣告上架、下架、編輯，管理員管理'),
(2, '商城管理', '查看、處理商城商品'),
(3, '活動管理', '查看、管理活動資料');    
    
-- 角色權限表 --   
    
 CREATE TABLE ADMIN_TYPE_FUNC_LIST (
    ADMIN_TYPE_ID INT NOT NULL PRIMARY KEY,
    ADMIN_FUNC_ID INT NOT NULL PRIMARY KEY,

INSERT INTO ADMIN_TYPE_FUNC_LIST (ADMIN_TYPE_ID, ADMIN_FUNC_ID) VALUES
(1, 1),
(1, 2),
(1, 3),
(2, 1),
(2, 2),
(3, 2);
    
    
-- FK --   
    
ALTER TABLE PRODUCT
ADD CONSTRAINT PRO_F_MEM_ID_FK
FOREIGN KEY (F_MEM_ID) REFERENCES F_MEM(F_MEM_ID);

ALTER TABLE PRODUCT
ADD CONSTRAINT PRO_PRO_CATE_ID_FK
FOREIGN KEY (PRO_CATE_ID) REFERENCES PRODUCT_CATEGORY(PRO_CATE_ID);
    
ALTER TABLE ADMINISTRATOR
ADD CONSTRAINT ADMIN_TYPE_ID_FK
FOREIGN KEY (ADMIN_TYPE_ID) REFERENCES ADMIN_TYPE(ADMIN_TYPE_ID);

ALTER TABLE ADMIN_TYPE_FUNC_LIST
ADD CONSTRAINT ATFL_ADMIN_TYPE_ID_FK
FOREIGN KEY (ADMIN_TYPE_ID) REFERENCES ADMIN_TYPE(ADMIN_TYPE_ID);

ALTER TABLE ADMIN_TYPE_FUNC_LIST
ADD CONSTRAINT ATFL_ADMIN_FUNC_ID_FK
FOREIGN KEY (ADMIN_FUNC_ID) REFERENCES ADMIN_FUNCTION(ADMIN_FUNC_ID);
